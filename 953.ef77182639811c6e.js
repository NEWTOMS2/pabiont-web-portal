"use strict";(self.webpackChunkpabiont_web_portal=self.webpackChunkpabiont_web_portal||[]).push([[953],{1953:(z,d,n)=>{n.r(d),n.d(d,{DriverManagementModule:()=>k});var p=n(9808),c=n(7330),M=n(5861),e=n(5e3),s=n(3075),f=n(272),h=n(9643),g=n(9783),v=n(1424),_=n(2537),b=n(5652);function y(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"El nombre es obligatorio."),e.qZA())}function x(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"el nombre debe tener al menos 2 caracteres"),e.qZA())}function A(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"El apellido es obligatorio."),e.qZA())}function U(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"el apellido debe tener al menos 2 caracteres"),e.qZA())}function q(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"El Tel\xe9fono es Obligatorio."),e.qZA())}function D(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"la licencia no cumple el formato X0000000"),e.qZA())}function F(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"La Fecha es obligatoria."),e.qZA())}function I(o,a){1&o&&(e.TgZ(0,"small",18),e._uU(1,"el email no cumple el formato xxxxx@xxxx.xxx"),e.qZA())}const m=function(o){return{"ng-dirty ng-invalid":o}};let C=(()=>{class o{constructor(r,t,i,l){this.formBuilder=r,this.usersManagementService=t,this.messageService=i,this.datepipe=l,this.rolList=[{label:"Chofer",value:"Chofer"}],this.idEmpresa=1,this.isUpdate=!1,this.today=new Date,this.updateList=new e.vpe,this.buttonEnabled=new e.vpe,this.resetForm()}ngOnInit(){}convertirTexto(r){return CryptoJS.AES.encrypt(r,"pabiont123").toString()}resetForm(){this.formGroup=this.formBuilder.group({first_name:["",[s.kI.required,s.kI.pattern(/^[a-zA-Z\xe0\xe1\xe2\xe4\xe3\xe5\u0105\u010d\u0107\u0119\xe8\xe9\xea\xeb\u0117\u012f\xec\xed\xee\xef\u0142\u0144\xf2\xf3\xf4\xf6\xf5\xf8\xf9\xfa\xfb\xfc\u0173\u016b\xff\xfd\u017c\u017a\xf1\xe7\u010d\u0161\u017e\xc0\xc1\xc2\xc4\xc3\xc5\u0104\u0106\u010c\u0116\u0118\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\u012e\u0141\u0143\xd2\xd3\xd4\xd6\xd5\xd8\xd9\xda\xdb\xdc\u0172\u016a\u0178\xdd\u017b\u0179\xd1\xdf\xc7\u0152\xc6\u010c\u0160\u017d\u2202\xf0,.']+$/u)]],last_name:["",[s.kI.required,s.kI.pattern(/^[a-zA-Z\xe0\xe1\xe2\xe4\xe3\xe5\u0105\u010d\u0107\u0119\xe8\xe9\xea\xeb\u0117\u012f\xec\xed\xee\xef\u0142\u0144\xf2\xf3\xf4\xf6\xf5\xf8\xf9\xfa\xfb\xfc\u0173\u016b\xff\xfd\u017c\u017a\xf1\xe7\u010d\u0161\u017e\xc0\xc1\xc2\xc4\xc3\xc5\u0104\u0106\u010c\u0116\u0118\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\u012e\u0141\u0143\xd2\xd3\xd4\xd6\xd5\xd8\xd9\xda\xdb\xdc\u0172\u016a\u0178\xdd\u017b\u0179\xd1\xdf\xc7\u0152\xc6\u010c\u0160\u017d\u2202\xf0,.']+$/u)]],email:["",[s.kI.required,s.kI.pattern(/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/)]],rol:[""],phone:["",s.kI.required],license:["",[s.kI.required,s.kI.pattern(/^[A-Z]{1}[0-9]{7}$/i)]],date_exp_license:["",s.kI.required]}),this.formGroup.statusChanges.subscribe(r=>{this.buttonEnabled.emit("VALID"==r)})}submit(){this.finalDate=this.datepipe.transform(this.formGroup.controls.date_exp_license.value,"yyyy-MM-dd"),this.isUpdate?this.userRow=new f.s(this.formGroup.controls.first_name.value,this.formGroup.controls.last_name.value,this.formGroup.controls.email.value,"Chofer",this.formGroup.controls.phone.value,1,"",this.code,this.formGroup.controls.license.value,this.finalDate):(this.userRow=new f.s(this.formGroup.controls.first_name.value,this.formGroup.controls.last_name.value,this.formGroup.controls.email.value,"Chofer",this.formGroup.controls.phone.value,1,"",0,this.formGroup.controls.license.value,this.finalDate),console.log(this.userRow)),this.usersManagementService.saveUser(this.userRow,this.isUpdate).subscribe(r=>{this.messageService.add({severity:"success",summary:"Chofer creado o modificado correctamente.",detail:""}),this.updateList.emit()},r=>{r.error.some(t=>"User already exist"===t.error_description)?this.messageService.add({severity:"error",summary:"el Chofer ya existe, intente un correo diferente.",detail:""}):r.error.some(t=>"Driver license already exist"===t.error_description)?this.messageService.add({severity:"error",summary:"La licencia ya esta registrada, intente una diferente.",detail:""}):this.messageService.add({severity:"error",summary:"Ha ocurrido un error al crear o modificar el Usuario.",detail:""})})}enable(){this.formGroup.controls.email.enable(),this.formGroup.controls.license.enable(),this.isUpdate=!1}updateForm(r){this.formGroup.controls.rol.setValue(this.rolList.find(t=>r.rol==t.value)),this.formGroup.controls.first_name.setValue(r.first_name),this.formGroup.controls.last_name.setValue(r.last_name),this.formGroup.controls.email.setValue(r.email),this.formGroup.controls.phone.setValue(r.phone),this.formGroup.controls.license.setValue(r.license),this.formGroup.controls.date_exp_license.setValue(r.date_exp_license),this.idEmpresa=r.idEmpresa,this.code=r.code,this.formGroup.controls.license.disable(),this.isUpdate=!0}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(s.qu),e.Y36(h.D),e.Y36(g.ez),e.Y36(p.uU))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-create-form"]],outputs:{updateList:"updateList",buttonEnabled:"buttonEnabled"},decls:36,vars:35,consts:[[3,"formGroup"],[1,"row","p-formgrid","p-grid","mt-3"],[1,"p-field","col-6"],["for","First_name"],["type","text","id","First_name","pInputText","","formControlName","first_name","required","","autofocus","",3,"maxlength","minlength","ngClass"],["class","p-error",4,"ngIf"],["for","Last_name"],["type","text","id","Last_name","pInputText","","formControlName","last_name","required","","autofocus","",3,"maxlength","minlength","ngClass"],[1,"p-field","col-12"],["for","Phone"],["formControlName","phone","id","Tel\xe9fono","mask","+99 (999) 999-9999","placeholder","+99 (999) 999-9999",3,"ngClass"],["for","License"],["type","text","id","License","pInputText","","formControlName","license","required","","autofocus","",3,"maxlength","minlength","ngClass"],["for","Date_exp_license"],["inputId","basic","formControlName","date_exp_license","dateFormat","yy-mm-dd","appendTo","body","placeholder","fecha",1,"w-100",3,"showIcon","minDate","ngClass"],[1,"p-field","mt-3"],["for","Email"],["type","text","id","Email","placeholder","abcd@abcd.abcd","pInputText","","formControlName","email","required","","autofocus","",3,"ngClass"],[1,"p-error"]],template:function(r,t){1&r&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Primer Nombre"),e.qZA(),e._UZ(5,"input",4),e.YNc(6,y,2,0,"small",5),e.YNc(7,x,2,0,"small",5),e.qZA(),e.TgZ(8,"div",2)(9,"label",6),e._uU(10,"Apellido"),e.qZA(),e._UZ(11,"input",7),e.YNc(12,A,2,0,"small",5),e.YNc(13,U,2,0,"small",5),e.qZA()(),e.TgZ(14,"div",1)(15,"div",8)(16,"label",9),e._uU(17,"Tel\xe9fono"),e.qZA(),e._UZ(18,"p-inputMask",10),e.YNc(19,q,2,0,"small",5),e.qZA()(),e.TgZ(20,"div",1)(21,"div",2)(22,"label",11),e._uU(23,"Licencia"),e.qZA(),e._UZ(24,"input",12),e.YNc(25,D,2,0,"small",5),e.qZA(),e.TgZ(26,"div",2)(27,"label",13),e._uU(28,"Fecha de Vencimiento"),e.qZA(),e._UZ(29,"p-calendar",14),e.YNc(30,F,2,0,"small",5),e.qZA()(),e.TgZ(31,"div",15)(32,"label",16),e._uU(33,"Email"),e.qZA(),e._UZ(34,"input",17),e.YNc(35,I,2,0,"small",5),e.qZA()()),2&r&&(e.Q6J("formGroup",t.formGroup),e.xp6(5),e.Q6J("maxlength",20)("minlength",2)("ngClass",e.VKq(23,m,t.formGroup.controls.first_name.touched&&(null==t.formGroup.controls.first_name.errors?null:t.formGroup.controls.first_name.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.first_name.touched&&(null==t.formGroup.controls.first_name.errors?null:t.formGroup.controls.first_name.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.formGroup.controls.first_name.errors?null:t.formGroup.controls.first_name.errors.minlength),e.xp6(4),e.Q6J("maxlength",20)("minlength",2)("ngClass",e.VKq(25,m,t.formGroup.controls.last_name.touched&&(null==t.formGroup.controls.last_name.errors?null:t.formGroup.controls.last_name.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.last_name.touched&&(null==t.formGroup.controls.last_name.errors?null:t.formGroup.controls.last_name.errors.required)),e.xp6(1),e.Q6J("ngIf",null==t.formGroup.controls.last_name.errors?null:t.formGroup.controls.last_name.errors.minlength),e.xp6(5),e.Q6J("ngClass",e.VKq(27,m,t.formGroup.controls.phone.touched&&(null==t.formGroup.controls.phone.errors?null:t.formGroup.controls.phone.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.phone.touched&&(null==t.formGroup.controls.phone.errors?null:t.formGroup.controls.phone.errors.required)),e.xp6(5),e.Q6J("maxlength",20)("minlength",8)("ngClass",e.VKq(29,m,t.formGroup.controls.license.touched&&(null==t.formGroup.controls.license.errors?null:t.formGroup.controls.license.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.license.touched&&t.formGroup.controls.license.invalid),e.xp6(4),e.Q6J("showIcon",!0)("minDate",t.today)("ngClass",e.VKq(31,m,t.formGroup.controls.date_exp_license.touched&&(null==t.formGroup.controls.date_exp_license.errors?null:t.formGroup.controls.date_exp_license.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.date_exp_license.touched&&(null==t.formGroup.controls.date_exp_license.errors?null:t.formGroup.controls.date_exp_license.errors.required)),e.xp6(4),e.Q6J("ngClass",e.VKq(33,m,t.formGroup.controls.email.touched&&(null==t.formGroup.controls.email.errors?null:t.formGroup.controls.email.errors.required))),e.xp6(1),e.Q6J("ngIf",t.formGroup.controls.email.touched&&t.formGroup.controls.email.invalid))},directives:[s._Y,s.JL,s.sg,s.Fj,v.o,s.JJ,s.u,s.Q7,s.nD,s.wO,p.mk,p.O5,_.vy,b.f],styles:[""]}),o})();var J=n(4948),E=n(135),G=n(7773),L=n(3833),Z=n(5315),T=n(845);function N(o,a){if(1&o){const r=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(r),e.oxw().hideDialog()}),e.qZA(),e.TgZ(1,"button",11),e.NdJ("click",function(){e.CHM(r);const i=e.oxw(),l=e.MAs(8);return i.hideDialog(),l.submit()}),e.qZA()}if(2&o){const r=e.oxw();e.xp6(1),e.Q6J("disabled",!r.buttonIsEnabled)}}const Q=function(){return{width:"450px"}},S=[{path:"",component:(()=>{class o{constructor(r,t,i,l){this.appConfig=r,this.tableManagmentService=t,this.userManagementService=i,this.router=l,this.visibleDialog=!1,this.buttonIsEnabled=!1,this.userList=[],this.currentStep=-1,this.page=this.appConfig.driverManagement,this.page=this.page.default,this.getUserList(),this.tableManagmentService.buttonEvent.subscribe(u=>{this.selectedButton(u)})}ngOnInit(){}getUserList(){var r=this;return(0,M.Z)(function*(){r.userList=yield r.userManagementService.getUserChofer().toPromise().then(t=>t)})()}buttonEnabled(r){this.buttonIsEnabled=r}selectedButton(r){switch(this.visibleDialog=!0,this.currentStep=r.buttonId,r.buttonId){case 0:this.child.enable();break;case 1:this.child.updateForm(r.rowData)}}hideDialog(){this.visibleDialog=!1,this.currentStep=-1}redirect(){this.router.navigate(["main"])}}return o.\u0275fac=function(r){return new(r||o)(e.Y36(J._),e.Y36(E.l),e.Y36(h.D),e.Y36(c.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-driver-management"]],viewQuery:function(r,t){if(1&r&&e.Gf(C,5),2&r){let i;e.iGM(i=e.CRH())&&(t.child=i.first)}},decls:12,vars:11,consts:[[1,"row","p-4","m-0"],[1,"title"],[1,"pabiont-card"],[3,"headerList","headerCustomButtons","customButtons","dataList","searchField","canCreate"],["header","Agregar o Modificar Choferes","styleClass","p-fluid",3,"visible","modal","visibleChange","onHide"],[3,"buttonEnabled","updateList"],["child",""],["class","m-0","pTemplate","footer"],[1,"d-flex","justify-content-start","px-4","mb-3"],["pButton","","pRipple","","label","Volver",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-check",1,"p-button-text",3,"disabled","click"]],template:function(r,t){if(1&r){const i=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"span",1),e._uU(3,"Gesti\xf3n de Choferes"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"app-basic-table",3),e.qZA()(),e.TgZ(6,"p-dialog",4),e.NdJ("visibleChange",function(u){return t.visibleDialog=u})("onHide",function(){return e.CHM(i),e.MAs(8).resetForm()}),e.TgZ(7,"app-create-form",5,6),e.NdJ("buttonEnabled",function(u){return t.buttonEnabled(u)})("updateList",function(){return t.getUserList()}),e.qZA(),e.YNc(9,N,2,1,"ng-template",7),e.qZA(),e.TgZ(10,"div",8)(11,"button",9),e.NdJ("click",function(){return t.redirect()}),e.qZA()()}2&r&&(e.xp6(5),e.Q6J("headerList",t.page.tableConfiguration.headerList)("headerCustomButtons",t.page.tableConfiguration.headerCustomButtons)("customButtons",t.page.tableConfiguration.customButtons)("dataList",t.userList)("searchField",t.page.tableConfiguration.searchField)("canCreate",!0),e.xp6(1),e.Akn(e.DdM(10,Q)),e.Q6J("visible",t.visibleDialog)("modal",!0))},directives:[G.FN,L.N,Z.V,C,g.jx,T.Hq],styles:[".title[_ngcontent-%COMP%]{font-weight:600;font-size:32px;line-height:27px;color:#000;margin-bottom:48px}.pabiont-card[_ngcontent-%COMP%]{border-radius:20px;border:2px solid rgba(0,0,0,.05);box-shadow:0 4px 4px #00000040}@media only screen and (max-width: 576px){[_nghost-%COMP%]     .p-toast-top-right{right:0!important}[_nghost-%COMP%]     .p-toast{padding:10px!important;width:100%!important}}"]}),o})()}];let V=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[c.Bz.forChild(S)],c.Bz]}),o})();var Y=n(732),B=n(4036);let k=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[p.ez,V,Y.T,T.hJ,v.j,Z.S,s.UX,B.kW,_.zz,G.EV,b._8]]}),o})()}}]);