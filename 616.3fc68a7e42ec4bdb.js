"use strict";(self.webpackChunkpabiont_web_portal=self.webpackChunkpabiont_web_portal||[]).push([[616],{1616:(z,d,r)=>{r.r(d),r.d(d,{ClientManagementModule:()=>Q});var p=r(9808),c=r(7330),M=r(5861),e=r(5e3),s=r(3075),f=r(272),g=r(9643),h=r(9783),C=r(1424),b=r(2537);function T(n,i){1&n&&(e.TgZ(0,"small",14),e._uU(1,"El nombre es obligatorio."),e.qZA())}function A(n,i){1&n&&(e.TgZ(0,"small",14),e._uU(1,"El apellido es obligatorio."),e.qZA())}function E(n,i){1&n&&(e.TgZ(0,"small",14),e._uU(1,"El Tel\xe9fono es Obligatorio."),e.qZA())}function F(n,i){1&n&&(e.TgZ(0,"small",14),e._uU(1,"El email es obligatorio."),e.qZA())}const u=function(n){return{"ng-dirty ng-invalid":n}};let v=(()=>{class n{constructor(t,o,a){this.formBuilder=t,this.usersManagementService=o,this.messageService=a,this.rolList=[{label:"Cliente",value:"Cliente"}],this.idEmpresa=1,this.isUpdate=!1,this.updateList=new e.vpe,this.buttonEnabled=new e.vpe,this.resetForm()}ngOnInit(){}convertirTexto(t){return CryptoJS.AES.encrypt(t,"pabiont123").toString()}resetForm(){this.formGroup=this.formBuilder.group({first_name:["",[s.kI.required,s.kI.pattern("[a-zA-Z ]*")]],last_name:["",[s.kI.required,s.kI.pattern("[a-zA-Z ]*")]],email:["",[s.kI.required,s.kI.pattern(/^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/)]],rol:[""],phone:["",s.kI.required]}),this.formGroup.statusChanges.subscribe(t=>{this.buttonEnabled.emit("VALID"==t)})}submit(){this.userRow=this.isUpdate?new f.s(this.formGroup.controls.first_name.value,this.formGroup.controls.last_name.value,this.formGroup.controls.email.value,"Cliente",this.formGroup.controls.phone.value,1,"",this.code):new f.s(this.formGroup.controls.first_name.value,this.formGroup.controls.last_name.value,this.formGroup.controls.email.value,"Cliente",this.formGroup.controls.phone.value,this.idEmpresa),this.usersManagementService.saveUser(this.userRow,this.isUpdate).subscribe(t=>{this.messageService.add({severity:"success",summary:"Cliente creado o modificado correctamente.",detail:""}),this.updateList.emit()},t=>{this.messageService.add({severity:"error",summary:"Ha ocurrido un error al crear o modificar el Cliente.",detail:""}),console.log(t)})}enable(){this.formGroup.controls.email.enable(),this.formGroup.controls.rol.enable()}updateForm(t){this.formGroup.controls.rol.setValue(this.rolList.find(o=>t.rol==o.value)),this.formGroup.controls.first_name.setValue(t.first_name),this.formGroup.controls.last_name.setValue(t.last_name),this.formGroup.controls.email.setValue(t.email),this.formGroup.controls.phone.setValue(t.phone),this.idEmpresa=t.idEmpresa,this.code=t.code,this.formGroup.controls.email.disable(),this.formGroup.controls.rol.disable(),this.isUpdate=!0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(g.D),e.Y36(h.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-form"]],outputs:{updateList:"updateList",buttonEnabled:"buttonEnabled"},decls:23,vars:17,consts:[[3,"formGroup"],[1,"row","p-formgrid","p-grid","mt-3"],[1,"p-field","col-6"],["for","First_name"],["type","text","id","First_name","pattern","[a-zA-Z ]*","pInputText","","formControlName","first_name","required","","autofocus","",3,"ngClass"],["class","p-error",4,"ngIf"],["for","Last_name"],["type","text","id","Last_name","pattern","[a-zA-Z ]*","pInputText","","formControlName","last_name","required","","autofocus","",3,"ngClass"],[1,"p-field","col-12"],["for","Phone"],["formControlName","phone","id","Tel\xe9fono","mask","+99 (999) 999-9999","placeholder","+99 (999) 999-9999",3,"ngClass"],[1,"p-field","mt-3"],["for","Email"],["type","text","id","Email","placeholder","abcd@abcd.abcd","pInputText","","formControlName","email","required","","autofocus","",3,"ngClass"],[1,"p-error"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),e._uU(4,"Nombre"),e.qZA(),e._UZ(5,"input",4),e.YNc(6,T,2,0,"small",5),e.qZA(),e.TgZ(7,"div",2)(8,"label",6),e._uU(9,"Apellido"),e.qZA(),e._UZ(10,"input",7),e.YNc(11,A,2,0,"small",5),e.qZA()(),e.TgZ(12,"div",1)(13,"div",8)(14,"label",9),e._uU(15,"Tel\xe9fono"),e.qZA(),e._UZ(16,"p-inputMask",10),e.YNc(17,E,2,0,"small",5),e.qZA()(),e.TgZ(18,"div",11)(19,"label",12),e._uU(20,"Email"),e.qZA(),e._UZ(21,"input",13),e.YNc(22,F,2,0,"small",5),e.qZA()()),2&t&&(e.Q6J("formGroup",o.formGroup),e.xp6(5),e.Q6J("ngClass",e.VKq(9,u,o.formGroup.controls.first_name.touched&&(null==o.formGroup.controls.first_name.errors?null:o.formGroup.controls.first_name.errors.required))),e.xp6(1),e.Q6J("ngIf",o.formGroup.controls.first_name.touched&&(null==o.formGroup.controls.first_name.errors?null:o.formGroup.controls.first_name.errors.required)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,u,o.formGroup.controls.last_name.touched&&(null==o.formGroup.controls.last_name.errors?null:o.formGroup.controls.last_name.errors.required))),e.xp6(1),e.Q6J("ngIf",o.formGroup.controls.last_name.touched&&(null==o.formGroup.controls.last_name.errors?null:o.formGroup.controls.last_name.errors.required)),e.xp6(5),e.Q6J("ngClass",e.VKq(13,u,o.formGroup.controls.phone.touched&&(null==o.formGroup.controls.phone.errors?null:o.formGroup.controls.phone.errors.required))),e.xp6(1),e.Q6J("ngIf",o.formGroup.controls.phone.touched&&(null==o.formGroup.controls.phone.errors?null:o.formGroup.controls.phone.errors.required)),e.xp6(4),e.Q6J("ngClass",e.VKq(15,u,o.formGroup.controls.email.touched&&(null==o.formGroup.controls.email.errors?null:o.formGroup.controls.email.errors.required))),e.xp6(1),e.Q6J("ngIf",o.formGroup.controls.email.touched&&(null==o.formGroup.controls.email.errors?null:o.formGroup.controls.email.errors.required)))},directives:[s._Y,s.JL,s.sg,s.Fj,s.c5,C.o,s.JJ,s.u,s.Q7,p.mk,p.O5,b.vy],styles:[""]}),n})();var y=r(6456),U=r(135),_=r(7773),I=r(3833),G=r(5315),Z=r(845);function J(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){return e.CHM(t),e.oxw().hideDialog()}),e.qZA(),e.TgZ(1,"button",11),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(),l=e.MAs(8);return a.hideDialog(),l.submit()}),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("disabled",!t.buttonIsEnabled)}}const L=function(){return{width:"450px"}},q=[{path:"",component:(()=>{class n{constructor(t,o,a,l){this.appConfig=t,this.tableManagmentService=o,this.userManagementService=a,this.router=l,this.visibleDialog=!1,this.buttonIsEnabled=!1,this.userList=[],this.currentStep=-1,this.page=this.appConfig.userManagement,this.page=this.page.default,this.getUserList(),this.tableManagmentService.buttonEvent.subscribe(m=>{this.selectedButton(m)})}ngOnInit(){}getUserList(){var t=this;return(0,M.Z)(function*(){t.userList=yield t.userManagementService.getUserClient().toPromise().then(o=>o)})()}buttonEnabled(t){this.buttonIsEnabled=t}selectedButton(t){switch(this.visibleDialog=!0,this.currentStep=t.buttonId,t.buttonId){case 0:this.child.enable();break;case 1:this.child.updateForm(t.rowData)}}hideDialog(){this.visibleDialog=!1}redirect(){this.router.navigate(["main"])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(y._),e.Y36(U.l),e.Y36(g.D),e.Y36(c.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-client-management"]],viewQuery:function(t,o){if(1&t&&e.Gf(v,5),2&t){let a;e.iGM(a=e.CRH())&&(o.child=a.first)}},decls:12,vars:11,consts:[[1,"row","p-5","m-0"],[1,"title"],[1,"pabiont-card"],[3,"headerList","headerCustomButtons","customButtons","dataList","searchField","canCreate"],["header","Agregar o Modificar Clientes","styleClass","p-fluid",3,"visible","modal","visibleChange","onHide"],[3,"buttonEnabled","updateList"],["child",""],["class","m-0","pTemplate","footer"],[1,"d-flex","justify-content-start","px-5","mb-3"],["pButton","","pRipple","","label","Volver",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-text","p-button-danger",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-check",1,"p-button-text",3,"disabled","click"]],template:function(t,o){if(1&t){const a=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"span",1),e._uU(3,"Gesti\xf3n de Clientes"),e.qZA(),e.TgZ(4,"div",2),e._UZ(5,"app-basic-table",3),e.qZA()(),e.TgZ(6,"p-dialog",4),e.NdJ("visibleChange",function(m){return o.visibleDialog=m})("onHide",function(){return e.CHM(a),e.MAs(8).resetForm()}),e.TgZ(7,"app-create-form",5,6),e.NdJ("buttonEnabled",function(m){return o.buttonEnabled(m)})("updateList",function(){return o.getUserList()}),e.qZA(),e.YNc(9,J,2,1,"ng-template",7),e.qZA(),e.TgZ(10,"div",8)(11,"button",9),e.NdJ("click",function(){return o.redirect()}),e.qZA()()}2&t&&(e.xp6(5),e.Q6J("headerList",o.page.tableConfiguration.headerList)("headerCustomButtons",o.page.tableConfiguration.headerCustomButtons)("customButtons",o.page.tableConfiguration.customButtons)("dataList",o.userList)("searchField",o.page.tableConfiguration.searchField)("canCreate",!0),e.xp6(1),e.Akn(e.DdM(10,L)),e.Q6J("visible",o.visibleDialog)("modal",!0))},directives:[_.FN,I.N,G.V,v,h.jx,Z.Hq],styles:[".title[_ngcontent-%COMP%]{font-weight:600;font-size:32px;line-height:27px;color:#000;margin-bottom:48px}.pabiont-card[_ngcontent-%COMP%]{border-radius:20px;border:2px solid rgba(0,0,0,.05);box-shadow:0 4px 4px #00000040}"]}),n})()}];let B=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.Bz.forChild(q)],c.Bz]}),n})();var N=r(732),S=r(4036);let Q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[p.ez,B,N.T,Z.hJ,C.j,G.S,s.UX,S.kW,b.zz,_.EV]]}),n})()}}]);